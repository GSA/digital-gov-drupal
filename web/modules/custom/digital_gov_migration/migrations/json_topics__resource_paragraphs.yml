id: json_topics__resource_paragraphs
label: 'Import featured resource paragraphs for topics from Digital.gov Hugo'
migration_tags:
  - 'Topics Featured Resources'
  - 'digitalgov'
source:
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: json_topic_resources
  urls:
    - https://federalist-466b7d92-5da1-4208-974f-d61fd4348571.sites.pages.cloud.gov/preview/gsa/digitalgov.gov/nl-json-endpoints/topics/index.json
  # This is the path to where the data are in the JSON.
  item_selector: items
  ids:
    resource_uid:
      type: string
  constants:
    FORMAT_SINGLE: 'single_inline_html'
  fields:
    - name: parent_uid
      label: 'Parent Unique ID'
      selector: parent_uid
      # Hash generated by our custom fetcher
    - name: resource_uid
      label: 'UID'
      selector: resource_uid
    - name: resource_url
      label: 'Featured URL'
      selector: url
    - name: resource_title
      label: 'Resource Title'
      selector: title
    - name: resource_summary
      label: 'Resource Summary'
      selector: summary
process:
  field_link/uri:
    - plugin: callback
      callable: digital_gov_migration_make_url_local
      source: resource_url
  field_link/title: resource_title
  field_summary/value: resource_summary
  field_summary/format: constants/FORMAT_SINGLE

destination:
  # It's a paragraph entity
  plugin: 'entity_reference_revisions:paragraph'
  default_bundle: external_content

migration_dependencies: null
