id: json_topics__featured_links_ext
label: 'Import featured links as external paragraphs for topics from Digital.gov Hugo'
migration_tags:
  - 'Topics Featured Links Ext'
  - 'digitalgov'
source:
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: json_topic_featured_links_ext
  urls:
    - https://federalist-466b7d92-5da1-4208-974f-d61fd4348571.sites.pages.cloud.gov/preview/gsa/digitalgov.gov/nl-json-endpoints/topics/index.json
  # This is the path to where the data are in the JSON.
  item_selector: items
  ids:
    uid:
      type: string
  constants:
    FORMAT_SINGLE: 'single_inline_html'
  fields:
    - name: parent_uid
      label: 'Parent Unique ID'
      selector: parent_uid
      # Hash generated by our custom fetcher
    - name: uid
      label: 'UID'
      selector: uid
    - name: link_url
      label: 'Featured Link URL'
      selector: link_url
    - name: link_title
      label: 'Featured Link Title'
      selector: link_title
    - name: link_summary
      label: 'Featured Link Summary'
      selector: link_summary
process:
  field_link/uri:
    - plugin: callback
      callable: digital_gov_migration_make_url_local
      source: link_url
  field_link/title: link_title
  field_summary/value:
    - plugin: callback
      callable: digital_gov_migration_html_entity_decode
      source: field_summary
  field_summary/format: constants/FORMAT_SINGLE

destination:
  # It's a paragraph entity
  plugin: 'entity_reference_revisions:paragraph'
  default_bundle: external_content
migration_dependencies: null
